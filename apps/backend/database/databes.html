<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≥</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#1877F2',
            secondary: '#42b72a',
            bg: '#f0f2f5',
            darkbg: '#18191a',
            darkcard: '#242526',
            darkborder: '#3A3B3C'
          },
          boxShadow: {
            soft: '0 10px 20px rgba(0,0,0,.06), 0 6px 6px rgba(0,0,0,.04)'
          }
        }
      }
    };
  </script>
  <style>
    .modal-enter { opacity: 0; transform: translateY(6px) scale(.98); }
    .modal-enter-active { opacity: 1; transform: translateY(0) scale(1); transition: all .16s ease; }
    @media (max-width: 768px) {
      .card-grid { grid-template-columns: repeat(1, minmax(0, 1fr)); }
    }
  </style>
</head>

<body class="bg-bg dark:bg-darkbg text-gray-900 dark:text-white min-h-screen flex flex-col items-center">
  <header class="w-full max-w-7xl flex justify-between items-center px-4 sm:px-6 py-3 sm:py-4 shadow bg-white dark:bg-darkcard/90 backdrop-blur sticky top-0 z-50 border-b border-gray-200 dark:border-darkborder">
    <h1 class="text-lg sm:text-2xl font-bold text-primary">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∞‡∏™‡∏°‡πÅ‡∏ï‡πâ‡∏°‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≥</h1>
    <button onclick="toggleDarkMode()" class="inline-flex items-center gap-2 px-3 sm:px-4 py-2 rounded-xl bg-primary text-white hover:bg-blue-600 active:scale-[.98] focus:outline-none focus:ring-2 focus:ring-blue-300">
      <span aria-hidden>üåô</span><span class="hidden sm:inline">‡πÇ‡∏´‡∏°‡∏î‡∏ñ‡∏ô‡∏≠‡∏°‡∏™‡∏≤‡∏¢‡∏ï‡∏≤</span>
    </button>
  </header>

  <main class="w-full max-w-7xl p-4 sm:p-6 space-y-8 sm:space-y-10">
    <section class="grid card-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
      <div onclick="openModal('signup')" role="button" tabindex="0" class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft hover:shadow transition-all hover:translate-y-[-2px] active:scale-[.99] cursor-pointer text-center outline-none">
        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-300">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
        <p class="mt-1 text-3xl sm:text-4xl font-extrabold text-primary" id="signupCount">0</p>
      </div>
      <div onclick="openModal('redeem')" role="button" tabindex="0" class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft hover:shadow transition-all hover:translate-y-[-2px] active:scale-[.99] cursor-pointer text-center outline-none">
        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-300">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</p>
        <p class="mt-1 text-3xl sm:text-4xl font-extrabold text-primary" id="redeemCount">0</p>
      </div>
      <div onclick="openBranchModal()" role="button" tabindex="0" class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft hover:shadow transition-all hover:translate-y-[-2px] active:scale-[.99] cursor-pointer text-center outline-none">
        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-300">‡∏¢‡∏≠‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ï‡πâ‡∏°‡∏£‡∏ß‡∏° 4 ‡∏™‡∏≤‡∏Ç‡∏≤</p>
        <p class="mt-1 text-3xl sm:text-4xl font-extrabold text-primary" id="totalAddAll">0</p>
      </div>
    </section>

    <section>
      <h2 class="text-lg sm:text-xl font-semibold text-primary mb-3">üèÖ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h2>
      <div class="bg-white dark:bg-darkcard rounded-2xl border border-gray-200 dark:border-darkborder p-4 sm:p-5">
        <ul class="list-disc ml-5 sm:ml-6 space-y-1 text-gray-800 dark:text-white text-sm" id="topCustomers">
          <li>‡∏£‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</li>
        </ul>
      </div>
    </section>

    <section class="space-y-4 sm:space-y-6">
      <div class="flex flex-wrap justify-between items-center gap-3">
        <h2 class="text-lg sm:text-xl font-semibold text-primary">üìà ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>
        <select id="monthSelect" onchange="fetchDashboardDataWithDate()" class="border rounded-xl px-3 py-2 text-sm dark:bg-darkcard dark:text-white dark:border-darkborder focus:outline-none focus:ring-2 focus:ring-primary"></select>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
        <div class="bg-white dark:bg-darkcard p-4 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft">
          <h3 class="text-sm sm:text-base font-semibold mb-2 text-primary">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô 30 ‡∏ß‡∏±‡∏ô</h3>
          <canvas id="moneyChart" class="w-full h-56 sm:h-64"></canvas>
        </div>
        <div class="bg-white dark:bg-darkcard p-4 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft">
          <h3 class="text-sm sm:text-base font-semibold mb-2 text-primary">‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ï‡πâ‡∏° 30 ‡∏ß‡∏±‡∏ô</h3>
          <canvas id="addChart" class="w-full h-56 sm:h-64"></canvas>
        </div>
        <div class="bg-white dark:bg-darkcard p-4 rounded-2xl border border-gray-200 dark:border-darkborder shadow-soft">
          <h3 class="text-sm sm:text-base font-semibold mb-2 text-primary">‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏Å‡πÅ‡∏ï‡πâ‡∏° 30 ‡∏ß‡∏±‡∏ô</h3>
          <canvas id="redeemChart" class="w-full h-56 sm:h-64"></canvas>
        </div>
      </div>
    </section>

    <section class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
      <div onclick="window.open('dated.html','_blank','noopener');" role="button" tabindex="0" class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl shadow-soft border border-gray-200 dark:border-darkborder hover:shadow transition-all hover:translate-y-[-2px] cursor-pointer text-center">
        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-300">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≥</p>
        <p class="text-2xl sm:text-4xl font-bold text-primary">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</p>
      </div>
      <div onclick="window.open('uplodes.html','_blank','noopener');" role="button" tabindex="0" class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl shadow-soft border border-gray-200 dark:border-darkborder hover:shadow transition-all hover:translate-y-[-2px] cursor-pointer text-center">
        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-300">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</p>
        <p class="text-2xl sm:text-4xl font-bold text-primary">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</p>
      </div>
    </section>
  </main>

  <div id="modal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl max-w-sm w-full mx-auto border border-gray-200 dark:border-darkborder modal-enter modal-enter-active">
      <h2 class="text-base sm:text-lg font-bold text-primary mb-3" id="modalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h2>
      <ul class="space-y-2 text-sm text-gray-800 dark:text-gray-200">
        <li id="dailyDetail">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô: -</li>
        <li id="weeklyDetail">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå: -</li>
        <li id="monthlyDetail">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: -</li>
      </ul>
      <button onclick="closeModal()" class="mt-5 w-full px-4 py-2.5 rounded-xl bg-primary hover:bg-blue-600 text-white active:scale-[.99] focus:outline-none focus:ring-2 focus:ring-blue-300">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>

  <div id="modal-branches" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-darkcard p-5 sm:p-6 rounded-2xl max-w-sm w-full mx-auto border border-gray-200 dark:border-darkborder modal-enter modal-enter-active">
      <h2 class="text-base sm:text-lg font-bold text-primary mb-3" id="modalBranchesTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ï‡πâ‡∏°‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏Ç‡∏≤ (4 ‡∏™‡∏≤‡∏Ç‡∏≤)</h2>
      <ul id="branchListModal" class="list-disc pl-5 sm:pl-6 space-y-1 text-sm text-gray-800 dark:text-gray-200">
        <li>‡∏™‡∏≤‡∏Ç‡∏≤ 1: 0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
        <li>‡∏™‡∏≤‡∏Ç‡∏≤ 2: 0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
        <li>‡∏™‡∏≤‡∏Ç‡∏≤ 3: 0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
        <li>‡∏™‡∏≤‡∏Ç‡∏≤ 4: 0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
      </ul>
      <button onclick="closeBranchModal()" class="mt-5 w-full px-4 py-2.5 rounded-xl bg-primary hover:bg-blue-600 text-white active:scale-[.99] focus:outline-none focus:ring-2 focus:ring-blue-300">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js" defer></script>
  <script>
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    }
    if (localStorage.getItem('theme') === 'dark') {
      document.documentElement.classList.add('dark');
    }

    document.querySelectorAll('[role="button"]').forEach(el => {
      el.addEventListener('keydown', e => { if (e.key === 'Enter') { el.click(); }});
    });

    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.querySelectorAll('*').forEach(el => el.style.transition = 'none');
    }
  </script>
</body>
</html>
